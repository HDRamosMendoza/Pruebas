{"version":3,"sources":["../../../widgets/InfoSummary/VersionManager.js"],"names":["define","BaseVersionManager","VersionManager","versions","version","upgrader","oldConfig","countEnabled","tc","tc2","mainPanelIcon","toString","replace","lyrInfos","layerInfos","i","length","oldM","newM","li","imageData","panelImageData","indexOf","symbolData","displayFeatureCount","_highLightColor","featureDisplayOptions","groupEnabled","fields","groupField","name","label","clusterType","clusterSymbol","color","outline","width","type","style","s","panelHTML","svg","newConfig","upgradeFields","prototype","constructor"],"mappings":"AAACA,OAAO,CAAC,gCAAD,CAAP,EACD,UAAUC,kBAAV,EAA8B;;AAE5B,WAASC,cAAT,GAA0B;AACxB,SAAKC,QAAL,GAAgB,CAAC;AACfC,eAAS,KADM;AAEfC,gBAAU,kBAAUC,SAAV,EAAqB;AAC7B,eAAOA,SAAP;AACD;AAJc,KAAD,EAKb;AACDF,eAAS,KADR;AAEDC,gBAAU,kBAAUC,SAAV,EAAqB;AAC7B,eAAOA,SAAP;AACD;AAJA,KALa,EAUb;AACDF,eAAS,SADR;AAEDC,gBAAU,kBAAUC,SAAV,EAAqB;AAC7B,eAAOA,SAAP;AACD;AAJA,KAVa,EAeb;AACDF,eAAS,KADR;AAEDC,gBAAU,kBAAUC,SAAV,EAAqB;AAC7B,eAAOA,SAAP;AACD;AAJA,KAfa,EAoBb;AACDF,eAAS,OADR;AAEDC,gBAAU,kBAAUC,SAAV,EAAqB;AAC7B,eAAOA,SAAP;AACD;AAJA,KApBa,EAyBb;AACDF,eAAS,KADR;AAEDC,gBAAU,kBAAUC,SAAV,EAAqB;AAC7BA,kBAAUC,YAAV,GAAyB,IAAzB;;AAEA,YAAIC,EAAJ;AACA,YAAIC,GAAJ;;AAEA,YAAIC,gBAAgBJ,UAAUI,aAAV,CAAwBC,QAAxB,EAApB;AACAD,wBAAgBA,cAAcE,OAAd,CAAsB,OAAtB,EAA+B,EAA/B,CAAhB;AACAF,wBAAgBA,cAAcE,OAAd,CAAsB,QAAtB,EAAgC,+BAAhC,CAAhB;AACAF,wBAAgBA,cAAcE,OAAd,CAAsB,aAAtB,EAAqC,eAArC,CAAhB;AACAN,kBAAUI,aAAV,GAA0BA,aAA1B;AACA,YAAIG,WAAWP,UAAUQ,UAAzB;AACA,YAAID,QAAJ,EAAc;AACZ,eAAK,IAAIE,IAAI,CAAb,EAAgBA,IAAIF,SAASG,MAA7B,EAAqCD,GAArC,EAA0C;AACxC,gBAAIE,IAAJ;AACA,gBAAIC,IAAJ;AACA,gBAAIC,KAAKN,SAASE,CAAT,CAAT;AACA,gBAAII,GAAGC,SAAP,EAAkB;AAChB,kBAAIA,YAAY,iCAAiCD,GAAGC,SAApC,GAAgD,QAAhE;AACAA,0BAAYA,UAAUR,OAAV,CAAkB,4BAAlB,EAAgD,4BAAhD,CAAZ;AACAQ,0BAAYA,UAAUR,OAAV,CAAkB,4BAAlB,EAAgD,4BAAhD,CAAZ;AACAQ,0BAAYA,UAAUR,OAAV,CAAkB,mBAAlB,EAAuC,qBAAvC,CAAZ;AACAK,qBAAO,2EAAP;AACAC,qBAAO,6EAAP;AACAC,iBAAGC,SAAH,GAAeA,UAAUR,OAAV,CAAkBK,IAAlB,EAAwBC,IAAxB,CAAf;AACD;AACD,gBAAIC,GAAGE,cAAP,EAAuB;AACrB,kBAAIA,iBAAiBF,GAAGE,cAAxB;AACA,kBAAIA,eAAeC,OAAf,CAAuB,MAAvB,IAAiC,CAAC,CAAtC,EAAyC;AACvCD,iCAAiBA,eAAeT,OAAf,CAAuB,UAAvB,EAAmC,6CAAnC,CAAjB;AACD,eAFD,MAEO;AACLS,iCAAiBA,eAAeT,OAAf,CAAuB,4BAAvB,EAAqD,4BAArD,CAAjB;AACAS,iCAAiBA,eAAeT,OAAf,CAAuB,4BAAvB,EAAqD,4BAArD,CAAjB;AACAS,iCAAiBA,eAAeT,OAAf,CAAuB,qBAAvB,EAA8C,qBAA9C,CAAjB;AACAK,uBAAO,6EAAP;AACAC,uBAAO,6EAAP;AACAG,iCAAiBA,eAAeT,OAAf,CAAuBK,IAAvB,EAA6BC,IAA7B,CAAjB;AACD;AACDC,iBAAGE,cAAH,GAAoBA,cAApB;AACD;AACD,gBAAIF,GAAGI,UAAP,EAAmB;AACjB,kBAAIA,aAAaJ,GAAGI,UAApB;AACAA,yBAAWC,mBAAX,GAAiC,KAAjC;AACAD,yBAAWE,eAAX,GAA6B,SAA7B;AACAF,yBAAWG,qBAAX,GAAmC;AACjCC,8BAAc,KADmB;AAEjCC,wBAAQ,EAFyB;AAGjCC,4BAAY,EAAEC,MAAM,EAAR,EAAYC,OAAO,EAAnB;AAHqB,eAAnC;;AAMA,kBAAIR,WAAWS,WAAX,KAA2B,cAA/B,EAA+C;AAC7CxB,qBAAKe,WAAWU,aAAhB;AACAxB,sBAAMc,WAAWS,WAAjB;AACD;;AAED,kBAAIT,WAAWS,WAAX,KAA2B,cAA/B,EAA+C;AAC7C,oBAAIxB,EAAJ,EAAQ;AACNe,6BAAWS,WAAX,GAAyBvB,GAAzB;AACAc,6BAAWU,aAAX,GAA2BzB,EAA3B;AACD,iBAHD,MAGO;AACL;AACAe,6BAAWU,aAAX,GAA2B;AACzBC,2BAAO,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,GAAf,CADkB;AAEzBC,6BAAS;AACPD,6BAAO,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,GAAf,CADA;AAEPE,6BAAO,GAFA;AAGPC,4BAAM,SAHC;AAIPC,6BAAO;AAJA,qBAFgB;AAQzBD,0BAAM,SARmB;AASzBC,2BAAO;AATkB,mBAA3B;AAWD;AACF;;AAED,kBAAIf,WAAWgB,CAAf,EAAkB;AAChB,oBAAIC,YAAYjB,WAAWgB,CAA3B;AACA,oBAAIC,UAAUlB,OAAV,CAAkB,4BAAlB,IAAkD,CAAC,CAAvD,EAA0D;AACxDkB,8BAAYA,UAAU5B,OAAV,CAAkB,4BAAlB,EAAgD,4BAAhD,CAAZ;AACA4B,8BAAYA,UAAU5B,OAAV,CAAkB,4BAAlB,EAAgD,4BAAhD,CAAZ;AACA4B,8BAAYA,UAAU5B,OAAV,CAAkB,qBAAlB,EAAyC,qBAAzC,CAAZ;AACAK,yBAAO,6EAAP;AACAC,yBAAO,6EAAP;AACAsB,8BAAYA,UAAU5B,OAAV,CAAkBK,IAAlB,EAAwBC,IAAxB,CAAZ;AACAsB,8BAAYA,UAAU5B,OAAV,CAAkBK,IAAlB,EAAwBC,IAAxB,CAAZ;AACD,iBARD,MAQO,IAAIsB,UAAUlB,OAAV,CAAkB,eAAe,CAAC,CAAlC,CAAJ,EAA0C;AAC/C,sBAAImB,MAAM,mEAAV;AACAA,yBAAO,4CAAP;AACAA,yBAAO,kEAAP;AACAA,yBAAO,oDAAP;AACAA,yBAAO,gDAAP;AACAA,yBAAO,4EAAP;AACAA,yBAAO,eAAP;AACAA,yBAAOD,SAAP;AACAC,yBAAO,iBAAP;AACAA,yBAAO,gFAAP;AACAA,yBAAO,gBAAP;AACD;AACDlB,2BAAWiB,SAAX,GAAuBA,SAAvB;AACD;AACDrB,iBAAGI,UAAH,GAAgBA,UAAhB;AACD;AACDV,qBAASE,CAAT,IAAcI,EAAd;AACD;AACF;AACD,eAAOb,SAAP;AACD;AA5GA,KAzBa,EAsIb;AACDF,eAAS,KADR;AAEDC,gBAAU,kBAAUC,SAAV,EAAqB;AAC7B,eAAOA,SAAP;AACD;AAJA,KAtIa,EA2Ib;AACDF,eAAS,KADR;AAEDC,gBAAU,kBAAUC,SAAV,EAAqB;AAC7B,eAAOA,SAAP;AACD;AAJA,KA3Ia,EAgJb;AACDF,eAAS,KADR;AAEDC,gBAAU,kBAAUC,SAAV,EAAqB;AAC7B,eAAOA,SAAP;AACD;AAJA,KAhJa,EAqJd;AACAF,eAAS,KADT;AAEAC,gBAAU,kBAAUC,SAAV,EAAqB;AAC7B,YAAIoC,YAAYpC,SAAhB;AACAoC,kBAAUC,aAAV,GAA0B,IAA1B;AACA,eAAOD,SAAP;AACD;AAND,KArJc,CAAhB;AA6JD;;AAEDxC,iBAAe0C,SAAf,GAA2B,IAAI3C,kBAAJ,EAA3B;AACAC,iBAAe0C,SAAf,CAAyBC,WAAzB,GAAuC3C,cAAvC;AACA,SAAOA,cAAP;AACD,CAtKA","file":"VersionManager.js","sourcesContent":["ï»¿define(['jimu/shared/BaseVersionManager'],\r\nfunction (BaseVersionManager) {\r\n\r\n  function VersionManager() {\r\n    this.versions = [{\r\n      version: '1.3',\r\n      upgrader: function (oldConfig) {\r\n        return oldConfig;\r\n      }\r\n    }, {\r\n      version: '1.4',\r\n      upgrader: function (oldConfig) {\r\n        return oldConfig;\r\n      }\r\n    }, {\r\n      version: '2.0Beta',\r\n      upgrader: function (oldConfig) {\r\n        return oldConfig;\r\n      }\r\n    }, {\r\n      version: '2.0',\r\n      upgrader: function (oldConfig) {\r\n        return oldConfig;\r\n      }\r\n    }, {\r\n      version: '2.0.1',\r\n      upgrader: function (oldConfig) {\r\n        return oldConfig;\r\n      }\r\n    }, {\r\n      version: '2.1',\r\n      upgrader: function (oldConfig) {\r\n        oldConfig.countEnabled = true;\r\n\r\n        var tc;\r\n        var tc2;\r\n\r\n        var mainPanelIcon = oldConfig.mainPanelIcon.toString();\r\n        mainPanelIcon = mainPanelIcon.replace('><img', '');\r\n        mainPanelIcon = mainPanelIcon.replace('src=\\\"', 'style=\\\"background-image:url(');\r\n        mainPanelIcon = mainPanelIcon.replace('\\\" title=\\\"', ');\\\" title=\\\"');\r\n        oldConfig.mainPanelIcon = mainPanelIcon;\r\n        var lyrInfos = oldConfig.layerInfos;\r\n        if (lyrInfos) {\r\n          for (var i = 0; i < lyrInfos.length; i++) {\r\n            var oldM;\r\n            var newM;\r\n            var li = lyrInfos[i];\r\n            if (li.imageData) {\r\n              var imageData = '<div class=\\\"imageDataGFX\\\">' + li.imageData + '</div>';\r\n              imageData = imageData.replace('width=\\\"18\\\" height=\\\"18\\\"', 'width=\\\"28\\\" height=\\\"28\\\"');\r\n              imageData = imageData.replace('width=\\\"18\\\" height=\\\"18\\\"', 'width=\\\"28\\\" height=\\\"28\\\"');\r\n              imageData = imageData.replace('x=\\\"-9\\\" y=\\\"-9\\\"', 'x=\\\"-14\\\" y=\\\"-14\\\"');\r\n              oldM = 'matrix(1.00000000,0.00000000,0.00000000,1.00000000,9.00000000,9.00000000)';\r\n              newM = 'matrix(1.00000000,0.00000000,0.00000000,1.00000000,14.00000000,14.00000000)';\r\n              li.imageData = imageData.replace(oldM, newM);\r\n            }\r\n            if (li.panelImageData) {\r\n              var panelImageData = li.panelImageData;\r\n              if (panelImageData.indexOf('<img') > -1) {\r\n                panelImageData = panelImageData.replace('class=\\\"', 'style=\\\"width:44px; height:44px;\\\" class=\\\"');\r\n              } else {\r\n                panelImageData = panelImageData.replace('width=\\\"35\\\" height=\\\"35\\\"', 'width=\\\"44\\\" height=\\\"44\\\"');\r\n                panelImageData = panelImageData.replace('width=\\\"35\\\" height=\\\"35\\\"', 'width=\\\"44\\\" height=\\\"44\\\"');\r\n                panelImageData = panelImageData.replace('x=\\\"-18\\\" y=\\\"-18\\\"', 'x=\\\"-22\\\" y=\\\"-22\\\"');\r\n                oldM = 'matrix(1.00000000,0.00000000,0.00000000,1.00000000,17.50000000,17.50000000)';\r\n                newM = 'matrix(1.00000000,0.00000000,0.00000000,1.00000000,22.00000000,22.00000000)';\r\n                panelImageData = panelImageData.replace(oldM, newM);\r\n              }\r\n              li.panelImageData = panelImageData;\r\n            }\r\n            if (li.symbolData) {\r\n              var symbolData = li.symbolData;\r\n              symbolData.displayFeatureCount = false;\r\n              symbolData._highLightColor = '#ffffff';\r\n              symbolData.featureDisplayOptions = {\r\n                groupEnabled: false,\r\n                fields: [],\r\n                groupField: { name: \"\", label: \"\" }\r\n              };\r\n\r\n              if (symbolData.clusterType !== 'ThemeCluster') {\r\n                tc = symbolData.clusterSymbol;\r\n                tc2 = symbolData.clusterType;\r\n              }\r\n\r\n              if (symbolData.clusterType === 'ThemeCluster') {\r\n                if (tc) {\r\n                  symbolData.clusterType = tc2;\r\n                  symbolData.clusterSymbol = tc;\r\n                } else {\r\n                  //symbolData.clusterType = 'CustomCluster';\r\n                  symbolData.clusterSymbol = {\r\n                    color: [155, 187, 89, 128],\r\n                    outline: {\r\n                      color: [115, 140, 61, 255],\r\n                      width: 1.5,\r\n                      type: \"esriSLS\",\r\n                      style: \"esriSLSSolid\"\r\n                    },\r\n                    type: \"esriSFS\",\r\n                    style: \"esriSFSSolid\"\r\n                  };\r\n                }\r\n              }\r\n\r\n              if (symbolData.s) {\r\n                var panelHTML = symbolData.s;\r\n                if (panelHTML.indexOf('width=\\\"26\\\" height=\\\"26\\\"') > -1) {\r\n                  panelHTML = panelHTML.replace('width=\\\"26\\\" height=\\\"26\\\"', 'width=\\\"44\\\" height=\\\"44\\\"');\r\n                  panelHTML = panelHTML.replace('width=\\\"26\\\" height=\\\"26\\\"', 'width=\\\"44\\\" height=\\\"44\\\"');\r\n                  panelHTML = panelHTML.replace('x=\\\"-13\\\" y=\\\"-13\\\"', 'x=\\\"-22\\\" y=\\\"-22\\\"');\r\n                  oldM = 'matrix(1.00000000,0.00000000,0.00000000,1.00000000,13.00000000,13.00000000)';\r\n                  newM = 'matrix(1.00000000,0.00000000,0.00000000,1.00000000,22.00000000,22.00000000)';\r\n                  panelHTML = panelHTML.replace(oldM, newM);\r\n                  panelHTML = panelHTML.replace(oldM, newM);\r\n                } else if (panelHTML.indexOf('data:image' > -1)) {\r\n                  var svg = '<svg overflow=\\\"hidden\\\" width=\\\"44\\\" height=\\\"44\\\"><defs></defs>';\r\n                  svg += '<image fill-opacity=\\\"0\\\" stroke=\\\"none\\\" ';\r\n                  svg += 'stroke-opacity=\\\"0\\\" stroke-width=\\\"1\\\" stroke-linecap=\\\"butt\\\" ';\r\n                  svg += 'stroke-linejoin=\\\"miter\\\" stroke-miterlimit=\\\"4\\\" ';\r\n                  svg += 'x=\\\"-22\\\" y=\\\"-22\\\" width=\\\"44\\\" height=\\\"44\\\"';\r\n                  svg += 'preserveAspectRatio=\\\"none\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" ';\r\n                  svg += 'xlink:href=\\\"';\r\n                  svg += panelHTML;\r\n                  svg += '\\\" transform=\\\"';\r\n                  svg += 'matrix(1.00000000,0.00000000,0.00000000,1.00000000,22.00000000,22.00000000)\\\">';\r\n                  svg += '</image></svg>';\r\n                }\r\n                symbolData.panelHTML = panelHTML;\r\n              }\r\n              li.symbolData = symbolData;\r\n            }\r\n            lyrInfos[i] = li;\r\n          }\r\n        }\r\n        return oldConfig;\r\n      }\r\n    }, {\r\n      version: '2.2',\r\n      upgrader: function (oldConfig) {\r\n        return oldConfig;\r\n      }\r\n    }, {\r\n      version: '2.3',\r\n      upgrader: function (oldConfig) {\r\n        return oldConfig;\r\n      }\r\n    }, {\r\n      version: '2.4',\r\n      upgrader: function (oldConfig) {\r\n        return oldConfig;\r\n      }\r\n    },{\r\n      version: '2.5',\r\n      upgrader: function (oldConfig) {\r\n        var newConfig = oldConfig;\r\n        newConfig.upgradeFields = true;\r\n        return newConfig;\r\n      }\r\n    }];\r\n  }\r\n\r\n  VersionManager.prototype = new BaseVersionManager();\r\n  VersionManager.prototype.constructor = VersionManager;\r\n  return VersionManager;\r\n});"]}