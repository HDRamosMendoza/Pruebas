{"version":3,"sources":["../../../../widgets/InfoSummary2/setting/MySymbolPicker.js"],"names":["define","declare","_WidgetsInTemplateMixin","Select","ValidationTextBox","lang","html","domStyle","domConstruct","on","dom","gfx","query","Color","registry","jsonUtils","esriRequest","_Color","SymbolPicker1","BaseWidget","TabContainer","jimuUtils","Table","Message","ColorPicker","ImageChooser","array","SimpleMarkerSymbol","SimpleLineSymbol","PictureMarkerSymbol","template","Evented","templateString","baseClass","nls","row","layerInfo","clusteringEnabled","symbolInfo","symbolType","map","supportsDynamic","tabContainer","field_options","groupFeaturesEnabled","lyrSymbolSet","_highLightColor","panelHTML","svg","constructor","options","callerRow","renderer","geometryType","ac","layerId","value","fields","hidePanel","oidFieldName","popupFields","infoTemplate","info","fieldInfos","i","length","visible","push","fieldName","postMixInProperties","inherited","arguments","common","window","jimuNls","postCreate","_initImageChoosers","_setFields","_initTabControl","_initSymbolPickerTab","_initFeatureOptionsTab","own","btnAddField","hitch","_addFieldRow","fieldOptionsTable","fieldRows","getRows","removeClass","addClass","iconOptionsTextLabel","featureOptionsTextLabel","groupOptionsTextLabel","chkGroupLabel","rdoLayerIconLabel","rdoCustomIconLabel","chkGroup","set","rdoLayerIcon","rdoCustomIcon","imageIconChooser","format","GIF","JPEG","PNG","cropImage","showTip","goldenWidth","goldenHeight","domNode","place","uploadCustomIcon","imageSymbolChooser","uploadCustomSymbol","nulls","undefined","name","label","indexOf","alias","tabs","title","symbolOptions","content","symbolPickerContainer","panelFeatureDisplay","panelFeatureDisplayContainer","isNested","tabParent","startup","geom","geoType","getTypeByGeometryType","_loadLayerSymbol","_initSymbolPicker","_initClusterSymbolPicker","_addEventHandlers","_initSymbolUI","isInitalLoad","fieldLoadCount","selectField","type","width","fieldLabel","actions","selectable","autoHeight","placeAt","fieldOptions","_rowDeleted","grpFields","groupOptionsTable","groupFieldOptions","_initFeatureOptionsUI","fdo","featureDisplayOptions","_populateLayerRow","fieldLength","fI","groupEnabled","_chkGroupChanged","groupField","t","groupByField","_rdoGroupByFieldChanged","renGrouping","attributeField","field","field1","visualVariables","grpRenderer","groupByRenderer","_rdoGroupByRendererChanged","table","css","result","addRow","success","tr","_addFieldsOption","_addLabelOption","selectFields","labelText","message","max_records","lyrFields","clone","td","setStyle","selFields","style","height","cells","innerText","labelTextBox","clusterType","iconType","displayFeatureCount","userDefinedSymbol","_setSymbolType","_setClusterType","_setIconType","clusterSymbol","clusterPicker","showBySymbol","fromJson","chkClusterSym","_chkClusterChanged","rdoLayerSym","_rdoEsriSymChanged","_rdoCustomSymChanged","chkClusterCnt","_rdoCustomIconChanged","parent_div_uploadCustomSymbol","div_rdoEsriSym","v","symbolOverride","rdoEsriSym","_rdoLayerSymChanged","symbolPicker","symbol","rdoCustomSym","_createImageDataDiv","customSymbolPlaceholder","icon","updateImg","customIconPlaceholder","colorPicker","setColor","toString","img","document","createElement","innerHTML","children","src","toJson","remove","d","uploadImage","btnOk","ok","_setSymbol","emit","btnCancel","cancel","getSymbol","firstChild","ssss","layerSym","outerHTML","isCustom","_createImageDataDiv2","vals","ren","r","l","rVal","isNaN","description","classMaxValue","rendererVals","split","groupByRendererFields","attributeField2","attributeField3","_getFields","color","toHex","s","selectedId","selectedID","listDisabled","groupByRendererOptions","values","trs","flds","forEach","setLayerSymbol","byId","customSymbolDIV","grpClusterOptions","featureFont","clusterPickerContainer","_chkClusterCntChanged","_rdoLayerIconChanged","gt","symType","showByType","parent_div_clusterOptions","infos","sym","uniqueValueInfos","classBreakInfos","colorStops","colors","_c","c","fromArray","g","b","STYLE_CIRCLE","STYLE_SOLID","appendChild","_createCombinedImageDataDiv","w","h","isPanel","a","create","ar","setWidth","setHeight","size","setSize","mySurface","createSurface","descriptors","getShapeDescriptors","shape","createShape","defaultShape","setFill","fill","setStroke","stroke","applyTransform","dx","dy","url","convert","node","setSym","isDefault","onclick","layerSymbolClick","insertBefore","id","rawNode","evt","currentTarget","elm","idx","parentElement","child","data","join","editCustomSymbol","editCustomIcon","groupByOptions","rdoGroupField","rdoGroupRenderer","destroy","destroyRecursive"],"mappings":"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","file":"MySymbolPicker.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\n// Copyright © 2014 - 2018 Esri. All Rights Reserved.\n//\n// Licensed under the Apache License Version 2.0 (the 'License');\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an 'AS IS' BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n///////////////////////////////////////////////////////////////////////////\ndefine(['dojo/_base/declare', 'dijit/_WidgetsInTemplateMixin', 'dijit/form/Select', 'dijit/form/ValidationTextBox', 'dojo/_base/lang', 'dojo/_base/html', 'dojo/dom-style', 'dojo/dom-construct', 'dojo/on', 'dojo/dom', 'dojox/gfx', 'dojo/query', 'dojo/_base/Color', 'dijit/registry', 'esri/symbols/jsonUtils', 'esri/request', 'esri/Color', 'jimu/dijit/SymbolPicker', 'jimu/BaseWidget', 'jimu/dijit/TabContainer3', 'jimu/utils', 'jimu/dijit/SimpleTable', 'jimu/dijit/Message', 'jimu/dijit/ColorPicker', 'jimu/dijit/ImageChooser', 'dojo/_base/array', 'esri/symbols/SimpleMarkerSymbol', 'esri/symbols/SimpleLineSymbol', 'esri/symbols/PictureMarkerSymbol', 'dojo/text!./MySymbolPicker.html', 'dojo/Evented', 'dojox/form/FileUploader'], function (declare, _WidgetsInTemplateMixin, Select, ValidationTextBox, lang, html, domStyle, domConstruct, on, dom, gfx, query, Color, registry, jsonUtils, esriRequest, _Color, SymbolPicker1, BaseWidget, TabContainer, jimuUtils, Table, Message, ColorPicker, ImageChooser, array, SimpleMarkerSymbol, SimpleLineSymbol, PictureMarkerSymbol, template, Evented) {\n  return declare([BaseWidget, _WidgetsInTemplateMixin, Evented], {\n    templateString: template,\n    baseClass: 'jimu-widget-InfoSummary-setting',\n    nls: null,\n    row: null,\n    layerInfo: null,\n    clusteringEnabled: null,\n    symbolInfo: null,\n    symbolType: \"\",\n    map: null,\n    supportsDynamic: true,\n    tabContainer: null,\n    field_options: [],\n    groupFeaturesEnabled: false,\n    lyrSymbolSet: [],\n    _highLightColor: '#ffffff',\n    panelHTML: null,\n    svg: null,\n\n    /*jshint unused:false*/\n    constructor: function constructor( /*Object*/options) {\n      this.nls = options.nls;\n      this.row = options.callerRow;\n      this.layerInfo = options.layerInfo;\n      this.renderer = options.layerInfo.renderer;\n      this.geometryType = options.layerInfo.geometryType;\n      this.symbolInfo = options.symbolInfo;\n      this.map = options.map;\n      this.ac = options.ac;\n      this.layerId = options.value;\n      this.supportsDynamic = options.layerInfo.supportsDynamic;\n      this.fields = options.layerInfo.fields;\n      this.hidePanel = options.hidePanel;\n      this.oidFieldName = options.layerInfo.oidFieldName;\n      this.popupFields = [];\n      if (options.layerInfo.infoTemplate && options.layerInfo.infoTemplate.info) {\n        var fieldInfos = options.layerInfo.infoTemplate.info.fieldInfos;\n        if (fieldInfos) {\n          for (var i = 0; i < fieldInfos.length; i++) {\n            if (fieldInfos[i].visible) {\n              //TODO make sure this is pushing the alias\n              this.popupFields.push(fieldInfos[i].fieldName);\n            }\n          }\n        }\n      }\n    },\n\n    postMixInProperties: function postMixInProperties() {\n      this.inherited(arguments);\n      this.nls.common = window.jimuNls.common;\n    },\n\n    postCreate: function postCreate() {\n      this.inherited(arguments);\n      this._initImageChoosers();\n      this._setFields(this.fields);\n      this._initTabControl();\n      this._initSymbolPickerTab(this.geometryType);\n      this._initFeatureOptionsTab();\n      if (!this.hidePanel) {\n        this.own(on(this.btnAddField, 'click', lang.hitch(this, this._addFieldRow, this.fieldOptionsTable, 'loSelect')));\n        var fieldRows = this.fieldOptionsTable.getRows();\n        if (fieldRows && fieldRows.length >= 3) {\n          html.removeClass(this.btnAddField, \"btn-add-section\");\n          html.addClass(this.btnAddField, \"btn-add-section-disabled\");\n        } else {\n          html.removeClass(this.btnAddField, \"btn-add-section-disabled\");\n          html.addClass(this.btnAddField, \"btn-add-section\");\n        }\n        html.removeClass(this.iconOptionsTextLabel, 'text-disabled');\n        html.removeClass(this.featureOptionsTextLabel, 'text-disabled');\n        html.removeClass(this.groupOptionsTextLabel, 'text-disabled');\n        html.removeClass(this.chkGroupLabel, 'text-disabled');\n        html.removeClass(this.rdoLayerIconLabel, 'text-disabled');\n        html.removeClass(this.rdoCustomIconLabel, 'text-disabled');\n      } else {\n        html.removeClass(this.btnAddField, \"btn-add-section\");\n        html.addClass(this.btnAddField, \"btn-add-section-disabled\");\n        html.addClass(this.iconOptionsTextLabel, 'text-disabled');\n        html.addClass(this.featureOptionsTextLabel, 'text-disabled');\n        html.addClass(this.groupOptionsTextLabel, 'text-disabled');\n        html.addClass(this.chkGroupLabel, 'text-disabled');\n        html.addClass(this.rdoLayerIconLabel, 'text-disabled');\n        html.addClass(this.rdoCustomIconLabel, 'text-disabled');\n      }\n      this.chkGroup.set('disabled', this.hidePanel);\n      this.rdoLayerIcon.set('disabled', this.hidePanel);\n      this.rdoCustomIcon.set('disabled', this.hidePanel);\n    },\n\n    _initImageChoosers: function _initImageChoosers() {\n      this.imageIconChooser = new ImageChooser({\n        format: [ImageChooser.GIF, ImageChooser.JPEG, ImageChooser.PNG],\n        cropImage: false,\n        showTip: false,\n        goldenWidth: 10,\n        goldenHeight: 15\n      });\n      html.addClass(this.imageIconChooser.domNode, 'uploadCustom');\n      html.place(this.imageIconChooser.domNode, this.uploadCustomIcon, 'replace');\n\n      this.imageSymbolChooser = new ImageChooser({\n        format: [ImageChooser.GIF, ImageChooser.JPEG, ImageChooser.PNG],\n        cropImage: false,\n        showTip: false,\n        goldenWidth: 10,\n        goldenHeight: 15\n      });\n      html.addClass(this.imageSymbolChooser.domNode, 'uploadCustom');\n      html.place(this.imageSymbolChooser.domNode, this.uploadCustomSymbol, 'replace');\n    },\n\n    _setFields: function _setFields(fields) {\n      if (fields) {\n        this.field_options = [];\n        var nulls = [\"\", \" \", undefined, null];\n        for (var i = 0; i < fields.length; i++) {\n          this.field_options.push({\n            value: fields[i].name,\n            label: nulls.indexOf(fields[i].alias) === -1 ? fields[i].alias : fields[i].name\n          });\n        }\n      }\n    },\n\n    _initTabControl: function _initTabControl() {\n      this.tabContainer = new TabContainer({\n        tabs: [{\n          title: this.nls.symbolOptions,\n          content: this.symbolPickerContainer\n        }, {\n          title: this.nls.panelFeatureDisplay,\n          content: this.panelFeatureDisplayContainer\n        }],\n        isNested: true\n      }, this.tabParent);\n      this.tabContainer.startup();\n    },\n\n    _initSymbolPickerTab: function _initSymbolPickerTab(geom) {\n      var geoType = jimuUtils.getTypeByGeometryType(geom);\n      this._loadLayerSymbol();\n      if (this.supportsDynamic) {\n        this._initSymbolPicker(geoType);\n      }\n      this._initClusterSymbolPicker(geoType);\n      this._addEventHandlers(geoType);\n      //this._initUI();//change\n      this._initSymbolUI();\n    },\n\n    _initFeatureOptionsTab: function _initFeatureOptionsTab() {\n      this.isInitalLoad = true;\n      this.fieldLoadCount = 0;\n      var fields = [{\n        name: \"field\",\n        title: this.nls.selectField,\n        \"class\": \"label\",\n        type: \"empty\",\n        width: \"100px\"\n      }, {\n        name: \"label\",\n        \"class\": \"label\",\n        title: this.nls.fieldLabel,\n        type: \"empty\",\n        width: \"100px\"\n      }, {\n        name: \"actions\",\n        \"class\": \"label\",\n        title: this.nls.actions,\n        type: \"actions\",\n        actions: [\"up\", \"down\", \"delete\"],\n        width: \"50px\"\n      }];\n\n      this.fieldOptionsTable = new Table({\n        fields: fields,\n        selectable: false,\n        autoHeight: true\n      });\n\n      this.fieldOptionsTable.placeAt(this.fieldOptions);\n      this.fieldOptionsTable.startup();\n      this.fieldOptionsTable.on('row-delete', lang.hitch(this, this._rowDeleted));\n\n      var grpFields = [{\n        name: \"field\",\n        title: this.nls.selectField,\n        \"class\": \"label\",\n        type: \"empty\",\n        width: \"180px\" //change from 160\n      }, {\n        name: \"label\",\n        \"class\": \"label\",\n        title: this.nls.fieldLabel,\n        type: \"empty\",\n        width: \"140px\" //change from 160\n      }];\n\n      this.groupOptionsTable = new Table({\n        fields: grpFields,\n        selectable: false,\n        autoHeight: true\n      });\n\n      this.groupOptionsTable.placeAt(this.groupFieldOptions);\n      this.groupOptionsTable.startup();\n\n      this._initFeatureOptionsUI();\n      this.isInitalLoad = false;\n    },\n\n    _initFeatureOptionsUI: function _initFeatureOptionsUI() {\n      var fdo;\n      if (this.symbolInfo && this.symbolInfo.featureDisplayOptions) {\n        fdo = this.symbolInfo.featureDisplayOptions;\n      }\n\n      //fields options\n      if (fdo && fdo.fields) {\n        for (var i = 0; i < fdo.fields.length; i++) {\n          this._populateLayerRow(this.fieldOptionsTable, fdo.fields[i], 'loSelect');\n        }\n      } else {\n        this._addFieldRow(this.groupOptionsTable, 'goSelect');\n\n        if (this.popupFields && this.popupFields.length > 0) {\n          var fieldLength = this.popupFields.length > 2 ? 3 : this.popupFields.length;\n          for (var fI = 0; fI < fieldLength; fI++) {\n            this._populateLayerRow(this.fieldOptionsTable, {\n              name: this.popupFields[fI]\n            }, 'loSelect');\n          }\n        }\n      }\n\n      //group options\n      this.groupFeaturesEnabled = fdo && typeof fdo.groupEnabled !== 'undefined' ? fdo.groupEnabled : false;\n      this._chkGroupChanged(this.groupFeaturesEnabled);\n      this.chkGroup.set('checked', this.groupFeaturesEnabled);\n      if (fdo && fdo.groupField) {\n        this._populateLayerRow(this.groupOptionsTable, fdo.groupField, 'goSelect');\n      }\n\n      var t = true;\n      if (fdo && typeof fdo.groupByField !== 'undefined') {\n        this._rdoGroupByFieldChanged(fdo.groupByField);\n        t = false;\n      }\n\n      var renGrouping = false;\n      if (this.renderer) {\n        if (this.renderer.attributeField || this.renderer.field || this.renderer.field1) {\n          if (typeof this.renderer.visualVariables === 'undefined') {\n            renGrouping = true;\n          }\n        }\n      }\n      if (!renGrouping) {\n        domStyle.set(this.grpRenderer, 'display', 'none');\n      }\n      if (fdo && typeof fdo.groupByRenderer !== 'undefined') {\n        this._rdoGroupByRendererChanged(fdo.groupByRenderer);\n        t = false;\n      }\n      if (t) {\n        this._rdoGroupByFieldChanged(t);\n      }\n    },\n\n    _rowDeleted: function _rowDeleted(table) {\n      if (this.fieldOptionsTable.getRows().length < 3) {\n        html.removeClass(this.btnAddField, \"btn-add-section-disabled\");\n        html.addClass(this.btnAddField, \"btn-add-section\");\n      }\n    },\n\n    _populateLayerRow: function _populateLayerRow(table, field, css) {\n      this.fieldLoadCount += 1;\n      var result = table.addRow({});\n      if (result.success && result.tr) {\n        var tr = result.tr;\n        this._addFieldsOption(tr, css);\n        this._addLabelOption(tr);\n        tr.selectFields.set(\"value\", field.name);\n        tr.labelText.set(\"value\", field.label);\n      }\n    },\n\n    _addFieldRow: function _addFieldRow(table, css) {\n      if (table === this.fieldOptionsTable) {\n        if (table.getRows().length >= 3) {\n          new Message({\n            message: this.nls.max_records\n          });\n          return;\n        }\n      }\n\n      this.isInitalLoad = false;\n      var result = table.addRow({});\n      if (result.success && result.tr) {\n        var tr = result.tr;\n        this._addFieldsOption(tr, css);\n        this._addLabelOption(tr);\n      }\n\n      if (table === this.fieldOptionsTable) {\n        if (table.getRows().length >= 3) {\n          html.removeClass(this.btnAddField, \"btn-add-section\");\n          html.addClass(this.btnAddField, \"btn-add-section-disabled\");\n        }\n      }\n    },\n\n    _addFieldsOption: function _addFieldsOption(tr, css) {\n      var lyrFields = lang.clone(this.field_options);\n      var td = query('.simple-table-cell', tr)[0];\n      if (td) {\n        html.setStyle(td, \"verticalAlign\", \"middle\");\n        html.setStyle(td, \"line-height\", \"inherit\");\n        var selFields = new Select({\n          style: {\n            width: \"100%\",\n            height: \"28px\"\n          },\n          \"class\": css,\n          options: lyrFields\n        });\n        selFields.placeAt(td);\n        selFields.startup();\n        tr.selectFields = selFields;\n        this.own(on(selFields, 'change', lang.hitch(this, function () {\n          if (this.fieldLoadCount && this.fieldLoadCount > 0) {\n            this.fieldLoadCount -= 1;\n          } else {\n            tr.labelText.set('value', \"\");\n          }\n          tr.cells[0].title = tr.cells[0].innerText;\n        })));\n        tr.cells[0].title = tr.cells[0].innerText;\n      }\n    },\n\n    _addLabelOption: function _addLabelOption(tr) {\n      var td = query('.simple-table-cell', tr)[1];\n      html.setStyle(td, \"verticalAlign\", \"middle\");\n      html.setStyle(td, \"line-height\", \"inherit\");\n      var labelTextBox = new ValidationTextBox({\n        style: {\n          width: \"100%\",\n          height: \"28px\"\n        }\n      });\n      labelTextBox.placeAt(td);\n      labelTextBox.startup();\n      tr.labelText = labelTextBox;\n    },\n\n    _initSymbolUI: function _initSymbolUI() {\n      if (typeof this.symbolInfo !== 'undefined') {\n        //set retained symbol properties\n        this.symbolType = this.symbolInfo.symbolType;\n        this.clusterType = this.symbolInfo.clusterType;\n        this.iconType = this.symbolInfo.iconType;\n        this.displayFeatureCount = this.symbolInfo.displayFeatureCount;\n        this.clusteringEnabled = this.symbolInfo.clusteringEnabled;\n        this.userDefinedSymbol = this.symbolInfo.userDefinedSymbol;\n        this._highLightColor = this.symbolInfo._highLightColor;\n\n        this._setSymbolType(this.symbolInfo.symbolType);\n        this._setClusterType(this.symbolInfo.clusterType);\n        this._setIconType(this.symbolInfo.iconType);\n\n        //set cluster options properties\n        if (typeof this.symbolInfo.clusterType !== 'undefined') {\n          if (this.symbolInfo.clusterType === \"CustomCluster\") {\n            if (this.symbolInfo.clusterSymbol) {\n              this.clusterPicker.showBySymbol(jsonUtils.fromJson(this.symbolInfo.clusterSymbol));\n            }\n          }\n          this.userDefinedSymbol = true;\n        }\n        this.chkClusterSym.set('checked', this.symbolInfo.clusteringEnabled);\n        this._chkClusterChanged(this.symbolInfo.clusteringEnabled);\n      } else {\n        //default state\n        this.rdoLayerSym.set('checked', true);\n        this._rdoEsriSymChanged(false);\n        this._rdoCustomSymChanged(false);\n        this.chkClusterSym.set('checked', false);\n        this.chkClusterCnt.set('checked', false);\n        this.rdoLayerIcon.set('checked', true);\n        this._rdoCustomIconChanged(false);\n        this.symbolType = \"LayerSymbol\";\n        this.iconType = \"LayerIcon\";\n        this.clusteringEnabled = false;\n        this.userDefinedSymbol = false;\n      }\n\n      if (this.geometryType !== 'esriGeometryPoint' || !this.supportsDynamic) {\n        domStyle.set(this.parent_div_uploadCustomSymbol, \"display\", \"none\");\n        if (!this.supportsDynamic) {\n          domStyle.set(this.div_rdoEsriSym, \"display\", \"none\");\n        }\n      }\n    },\n\n    _setSymbolType: function _setSymbolType(v) {\n      switch (v) {\n        case 'LayerSymbol':\n          if (this.symbolInfo.symbolOverride) {\n            this.userDefinedSymbol = true;\n            this.rdoEsriSym.set('checked', true);\n            this._rdoLayerSymChanged(false);\n            this._rdoCustomSymChanged(false);\n            this.symbolPicker.showBySymbol(jsonUtils.fromJson(this.symbolInfo.symbol));\n          } else {\n            this.rdoLayerSym.set('checked', true);\n            this._rdoEsriSymChanged(false);\n            this._rdoCustomSymChanged(false);\n          }\n          break;\n        case 'EsriSymbol':\n          this.userDefinedSymbol = true;\n          this.rdoEsriSym.set('checked', true);\n          this._rdoLayerSymChanged(false);\n          this._rdoCustomSymChanged(false);\n          this.symbolPicker.showBySymbol(jsonUtils.fromJson(this.symbolInfo.symbol));\n          break;\n        case 'CustomSymbol':\n          this.userDefinedSymbol = true;\n          this.rdoCustomSym.set('checked', true);\n          this._rdoEsriSymChanged(false);\n          this._rdoLayerSymChanged(false);\n          this._createImageDataDiv(this.symbolInfo.symbol, true, this.customSymbolPlaceholder);\n          break;\n      }\n    },\n\n    _setIconType: function _setIconType(v) {\n      switch (v) {\n        case 'LayerIcon':\n          this.rdoLayerIcon.set('checked', true);\n          break;\n        case 'CustomIcon':\n          this.userDefinedSymbol = true;\n          this.rdoCustomIcon.set('checked', true);\n\n          if (this.symbolInfo.icon) {\n            this.updateImg();\n            var icon = jsonUtils.fromJson(this.symbolInfo.icon);\n            this._createImageDataDiv(icon, true, this.customIconPlaceholder);\n          }\n          break;\n      }\n    },\n\n    _setClusterType: function _setClusterType(v) {\n      switch (v) {\n        case 'ThemeCluster':\n          this.userDefinedSymbol = true;\n          this.clusterType = 'ThemeCluster';\n          break;\n        case 'CustomCluster':\n          this.userDefinedSymbol = true;\n          this.clusterType = 'CustomCluster';\n          this.chkClusterCnt.set('checked', this.displayFeatureCount);\n          this.colorPicker.setColor(new Color(this._highLightColor));\n          break;\n      }\n    },\n\n    updateImg: function updateImg() {\n      if (this.symbolInfo.icon.toString().indexOf('<img') > -1) {\n        var img = document.createElement('div');\n        img.innerHTML = this.symbolInfo.icon;\n        var icon = new PictureMarkerSymbol(img.children[0].src, 26, 26);\n        this.symbolInfo.icon = icon.toJson();\n        img.remove();\n      }\n    },\n\n    _addEventHandlers: function _addEventHandlers(geoType) {\n      if (geoType === 'point') {\n        this.own(on(this.imageSymbolChooser, 'ImageChange', lang.hitch(this, function (d) {\n          this.uploadImage(\"Symbol\", d);\n        })));\n      }\n\n      this.own(on(this.imageIconChooser, 'ImageChange', lang.hitch(this, function (d) {\n        this.uploadImage(\"Icon\", d);\n      })));\n\n      this.btnOk.innerText = this.nls.common.ok;\n      this.own(on(this.btnOk, 'click', lang.hitch(this, function () {\n        this._setSymbol();\n        this.emit('ok', this.symbolInfo);\n      })));\n\n      this.btnCancel.innerText = this.nls.common.cancel;\n      this.own(on(this.btnCancel, 'click', lang.hitch(this, function () {\n        this.emit('cancel');\n      })));\n    },\n\n    _setSymbol: function _setSymbol() {\n      //regardless of type we need to get and store in a common way\n      var symbol;\n      switch (this.symbolType) {\n        case 'LayerSymbol':\n          symbol = this.symbol;\n          break;\n        case 'EsriSymbol':\n          this.userDefinedSymbol = true;\n          symbol = this.symbolPicker.getSymbol();\n          break;\n        case 'CustomSymbol':\n          this.userDefinedSymbol = true;\n          if (this.customSymbolPlaceholder.children.length > 0) {\n            if (typeof this.customSymbolPlaceholder.children[0].src !== 'undefined') {\n              symbol = new PictureMarkerSymbol(this.customSymbolPlaceholder.children[0].src, 26, 26);\n            } else {\n              symbol = jsonUtils.fromJson(this.symbolInfo.symbol);\n            }\n          }\n          break;\n      }\n\n      var icon;\n      if (this.iconType === \"LayerIcon\") {\n        icon = symbol;\n      } else {\n        if (this.customIconPlaceholder.children.length > 0) {\n          if (typeof this.customIconPlaceholder.children[0].src !== 'undefined') {\n            html.removeClass(this.customIconPlaceholder.firstChild, 'customPlaceholder');\n            html.addClass(this.customIconPlaceholder.firstChild, 'customPlaceholderSettings');\n            icon = new PictureMarkerSymbol(this.customIconPlaceholder.children[0].src, 26, 26);\n          } else {\n            //this.updateImg();\n            icon = jsonUtils.fromJson(this.symbolInfo.icon);\n          }\n        }\n      }\n\n      if (this.clusteringEnabled && this.geometryType === 'esriGeometryPoint') {\n        if (this.clusterType === \"ThemeCluster\") {\n          this.clusterSymbol = \"custom\";\n        } else {\n          this.clusterSymbol = this.clusterPicker.getSymbol().toJson();\n        }\n        this.userDefinedSymbol = true;\n      } else {\n        this.clusterSymbol = undefined;\n        this.clusteringEnabled = false;\n      }\n\n      if (symbol) {\n        if (typeof symbol.toJson !== 'undefined') {\n          symbol = symbol.toJson();\n        }\n      }\n\n      var ssss;\n      if (this.customIconPlaceholder.children.length > 0) {\n        ssss = this.customIconPlaceholder.children[0].src;\n      } else if (this.layerSym.children.length > 0) {\n        ssss = this.layerSym.children[0].innerHTML;\n      } else {\n        ssss = this.customIconPlaceholder.outerHTML;\n      }\n\n      if (typeof icon !== 'undefined') {\n        var isCustom = this.iconType !== \"LayerIcon\" || this.symbolType === 'CustomSymbol';\n        this._createImageDataDiv2(icon, 44, 44, true, isCustom);\n        this._createImageDataDiv2(icon, 28, 28, false, isCustom);\n      }\n\n      var vals;\n      if (typeof this.ren !== 'undefined') {\n        vals = [];\n        for (var i = 0; i < this.ren.length; i++) {\n          var r = this.ren[i];\n          //var l, r, d;\n          var l, v, d;\n          if (typeof r.value !== 'undefined') {\n            var rVal = isNaN(r.value) ? \"'\" + r.value + \"'\" : r.value;\n            l = typeof r.label !== 'undefined' ? r.label : r.value;\n            v = typeof rVal !== 'undefined' ? \" === \" + rVal : undefined;\n            d = typeof r.description !== 'undefined' && r.description !== \"\" ? r.description : undefined;\n          } else if (typeof r.classMaxValue !== 'undefined') {\n            l = r.label;\n            var rendererVals;\n            if (l) {\n              rendererVals = l.split(\" - \");\n            }\n            if (rendererVals) {\n              if (rendererVals.length > 1) {\n                v = \" >= \" + rendererVals[0] + \" && <= \" + rendererVals[1];\n              } else {\n                v = \" === \" + rendererVals[0];\n              }\n            }\n            d = typeof r.description !== 'undefined' && r.description !== \"\" ? r.description : undefined;\n          }\n          vals.push({ value: v, label: l, description: d });\n        }\n      }\n\n      var groupByRendererFields = [];\n      if (this.renderer && this.renderer.attributeField) {\n        groupByRendererFields.push({ name: this.renderer.attributeField });\n        if (this.renderer.attributeField2) {\n          groupByRendererFields.push({ name: this.renderer.attributeField2 });\n        }\n        if (this.renderer.attributeField3) {\n          groupByRendererFields.push({ name: this.renderer.attributeField3 });\n        }\n      } else if (this.renderer && this.renderer.field) {\n        groupByRendererFields.push({ name: this.renderer.field });\n      } else if (this.renderer && this.renderer.field1) {\n        groupByRendererFields.push({ name: this.renderer.field1 });\n      }\n\n      var fields = this.fieldOptionsTable ? this._getFields(this.fieldOptionsTable) : null;\n\n      this.symbolInfo = {\n        symbolType: this.symbolType,\n        symbol: symbol,\n        clusterSymbol: this.clusterSymbol,\n        clusteringEnabled: this.clusteringEnabled,\n        displayFeatureCount: this.displayFeatureCount,\n        _highLightColor: this.colorPicker.color.toHex(),\n        icon: icon && icon.toJson ? icon.toJson() : icon,\n        clusterType: this.clusterType,\n        iconType: this.iconType,\n        renderer: this.renderer,\n        s: ssss,\n        svg: this.svg,\n        panelHTML: this.panelHTML,\n        userDefinedSymbol: this.userDefinedSymbol ? this.userDefinedSymbol : false,\n        layerId: this.layerId,\n        selectedId: this.selectedID,\n        featureDisplayOptions: {\n          groupEnabled: this.groupFeaturesEnabled,\n          listDisabled: fields && fields.length > 0 ? false : true,\n          groupByRenderer: typeof this.groupByRenderer === 'undefined' ? false : this.groupByRenderer,\n          groupByField: typeof this.groupByField === 'undefined' ? false : this.groupByField,\n          fields: fields,\n          groupField: this.groupOptionsTable ? this._getFields(this.groupOptionsTable)[0] : null,\n          groupByRendererOptions: {\n            fields: groupByRendererFields,\n            values: vals\n          }\n        }\n      };\n    },\n\n    _getFields: function _getFields(table) {\n      var trs = table.getRows();\n      var flds = [];\n      array.forEach(trs, function (tr) {\n        if (tr.selectFields) {\n          flds.push({\n            name: tr.selectFields.value,\n            label: tr.labelText.value\n          });\n        }\n      });\n      return flds;\n    },\n\n    _rdoLayerSymChanged: function _rdoLayerSymChanged(v) {\n      if (v) {\n        this.symbolType = \"LayerSymbol\";\n        if (this.selectedID) {\n          this.setLayerSymbol(dom.byId(this.selectedID));\n        }\n      }\n      html.setStyle(this.layerSym, 'display', v ? \"block\" : \"none\");\n    },\n\n    _rdoEsriSymChanged: function _rdoEsriSymChanged(v) {\n      if (v) {\n        this.symbolType = \"EsriSymbol\";\n      }\n      html.setStyle(this.symbolPicker.domNode, 'display', v ? \"block\" : \"none\");\n    },\n\n    _rdoCustomSymChanged: function _rdoCustomSymChanged(v) {\n      if (v) {\n        this.symbolType = \"CustomSymbol\";\n      }\n      html.setStyle(this.customSymbolDIV, 'display', v ? \"block\" : \"none\");\n    },\n\n    _chkClusterChanged: function _chkClusterChanged(v) {\n      this.clusteringEnabled = v;\n      html.setStyle(this.grpClusterOptions, 'display', v ? \"block\" : \"none\");\n      html.setStyle(this.featureFont, 'display', v ? \"block\" : \"none\");\n      html.setStyle(this.clusterPickerContainer, 'display', v ? \"block\" : \"none\");\n      if (v) {\n        if (typeof this.clusterType === 'undefined') {\n          this.clusterType = \"CustomCluster\";\n          //this.rdoCustomCluster.set('checked', true);\n        }\n      }\n    },\n\n    _chkClusterCntChanged: function _chkClusterCntChanged(v) {\n      this.displayFeatureCount = v;\n      html.setStyle(this.featureFont, 'display', v && this.clusteringEnabled ? \"block\" : \"none\");\n    },\n\n    _rdoLayerIconChanged: function _rdoLayerIconChanged(v) {\n      if (v) {\n        this.iconType = \"LayerIcon\";\n      }\n      html.setStyle(this.imageIconChooser.domNode, 'display', !v ? \"block\" : \"none\");\n      html.setStyle(this.customIconPlaceholder, 'display', !v ? \"block\" : \"none\");\n    },\n\n    _rdoCustomIconChanged: function _rdoCustomIconChanged(v) {\n      if (v) {\n        this.iconType = \"CustomIcon\";\n      }\n      html.setStyle(this.imageIconChooser.domNode, 'display', v ? \"block\" : \"none\");\n      html.setStyle(this.customIconPlaceholder, 'display', v ? \"block\" : \"none\");\n    },\n\n    _initSymbolPicker: function _initSymbolPicker(gt) {\n      var symType = gt === 'point' ? 'marker' : gt === 'polyline' ? 'line' : gt === 'polygon' ? 'fill' : '';\n      this.symbolPicker.showByType(symType);\n    },\n\n    _initClusterSymbolPicker: function _initClusterSymbolPicker(geoType) {\n      if (geoType === 'point') {\n        this.clusterPicker.showByType('fill');\n      }\n      var d = geoType === 'point' ? 'block' : 'none';\n      domStyle.set(this.parent_div_clusterOptions, \"display\", d);\n    },\n\n    _loadLayerSymbol: function _loadLayerSymbol() {\n      this.infos = undefined;\n      this.ren = undefined;\n      if (typeof this.renderer !== 'undefined') {\n        var renderer = this.renderer;\n        var sym;\n        var ren;\n        if (typeof renderer.symbol !== 'undefined') {\n          this._createImageDataDiv(renderer.symbol, true, this.layerSym);\n        } else if (typeof renderer.infos !== 'undefined') {\n          ren = renderer.infos;\n        } else if (typeof renderer.uniqueValueInfos !== 'undefined') {\n          ren = renderer.uniqueValueInfos;\n        } else if (typeof renderer.classBreakInfos !== 'undefined') {\n          ren = renderer.classBreakInfos;\n        } else if (renderer.type && renderer.type === 'heatmap' && renderer.colorStops) {\n          var colors = renderer.colorStops;\n          var infos = [];\n          if (colors && colors.length >= 1) {\n            var _c = colors[0].color;\n            var c = _Color.fromArray([_c.r, _c.g, _c.b]);\n            infos.push({\n              symbol: new SimpleMarkerSymbol(SimpleMarkerSymbol.STYLE_CIRCLE, 10, new SimpleLineSymbol(SimpleLineSymbol.STYLE_SOLID, c), c)\n            });\n            if (colors.length > 2) {\n              _c = colors[colors.length - 1].color;\n              c = _Color.fromArray([_c.r, _c.g, _c.b]);\n              infos.push({\n                symbol: new SimpleMarkerSymbol(SimpleMarkerSymbol.STYLE_CIRCLE, 10, new SimpleLineSymbol(SimpleLineSymbol.STYLE_SOLID, c), c)\n              });\n            }\n          }\n          this.infos = infos;\n          if (infos.length > 0) {\n            this.layerSym.appendChild(this._createCombinedImageDataDiv(infos));\n          } else {\n            this._createImageDataDiv2(undefined, 44, 44, true, false);\n            this._createImageDataDiv2(undefined, 28, 28, false, false);\n          }\n        } else {\n          this.rdoEsriSym.set('checked', true);\n          this.symbolType = \"EsriSymbol\";\n          this.iconType = \"LayerIcon\";\n          this._initSymbolPicker(jimuUtils.getTypeByGeometryType(this.geometryType));\n          this._setFields(this.fields);\n          this._setSymbol();\n          this.symbolInfo.symbolType = \"LayerSymbol\";\n          this.symbolInfo.symbolOverride = true;\n        }\n        if (ren) {\n          this.ren = ren;\n          this.layerSym.innerHTML = \"<div></div>\";\n          this.layerSym.appendChild(this._createCombinedImageDataDiv(ren));\n          html.setStyle(this.layerSym, \"cursor\", \"pointer\");\n        }\n      }\n    },\n\n    _createImageDataDiv2: function _createImageDataDiv2(sym, w, h, isPanel, isCustom) {\n      var a;\n      if (typeof sym === \"string\") {\n        a = domConstruct.create(\"div\", { 'class': \"imageDataGFX\", 'innerHTML': sym });\n        if (isPanel) {\n          this.panelHTML = a.innerHTML;\n        } else {\n          this.svg = a;\n        }\n      } else if (typeof sym === 'undefined') {\n        a = domConstruct.create(\"div\", { 'class': \"imageDataGFX\" });\n        a.innerHTML = '<div></div>';\n        if (isPanel) {\n          this.panelHTML = a.innerHTML;\n        } else {\n          this.svg = a;\n        }\n      } else {\n        var symbol = jsonUtils.fromJson(sym);\n        if (!symbol) {\n          symbol = sym;\n        }\n\n        if (symbol) {\n          var height = h;\n          var width = w;\n          if (symbol.height && symbol.width) {\n            var ar = symbol.width / symbol.height;\n            if (symbol.height > symbol.width) {\n              width = w * ar;\n            } else if (symbol.width > symbol.height) {\n              height = width / ar;\n            }\n          }\n          if (typeof symbol.setWidth !== 'undefined') {\n            if (typeof symbol.setHeight !== 'undefined') {\n              symbol.setWidth(isCustom ? width - width * 0.25 : width);\n              symbol.setHeight(isCustom ? height - height * 0.25 : height);\n            } else {\n              symbol.setWidth(2);\n            }\n          } else if (typeof symbol.size !== 'undefined') {\n            if (symbol.size > 20) {\n              symbol.setSize(20);\n            }\n          }\n          a = domConstruct.create(\"div\", { 'class': \"imageDataGFX\" });\n          var mySurface = gfx.createSurface(a, width, height);\n          var descriptors = jsonUtils.getShapeDescriptors(symbol);\n          var shape = mySurface.createShape(descriptors.defaultShape).setFill(descriptors.fill).setStroke(descriptors.stroke);\n          shape.applyTransform({ dx: width / 2, dy: height / 2 });\n          if (isPanel) {\n            this.panelHTML = a.innerHTML;\n          } else {\n            this.svg = a;\n          }\n        } else if (typeof sym.url !== 'undefined') {\n          a = domConstruct.create(\"div\", { 'class': \"imageDataGFX\" });\n          domStyle.set(a, \"background-image\", \"url(\" + sym.url + \")\");\n          domStyle.set(a, \"background-repeat\", \"no-repeat\");\n          if (isPanel) {\n            this.panelHTML = a.innerHTML;\n          } else {\n            this.svg = a;\n          }\n        }\n      }\n      return a;\n    },\n\n    _createImageDataDiv: function _createImageDataDiv(sym, convert, node) {\n      var a = domConstruct.create(\"div\", { 'class': \"imageDataGFX-display\" }, node);\n      var symbol = convert ? jsonUtils.fromJson(sym) : sym;\n      if (!symbol) {\n        symbol = sym;\n      }\n      this.symbol = symbol;\n      var height = 26;\n      var width = 26;\n      if (symbol.height && symbol.width) {\n        if (symbol.height > symbol.width) {\n          var ar = symbol.width / symbol.height;\n          height = 26;\n          width = 26 * ar;\n        }\n      }\n      var mySurface = gfx.createSurface(a, width, height);\n      var descriptors = jsonUtils.getShapeDescriptors(this.setSym(symbol, width, height));\n      var shape = mySurface.createShape(descriptors.defaultShape).setFill(descriptors.fill).setStroke(descriptors.stroke);\n      shape.applyTransform({ dx: width / 2, dy: height / 2 });\n      this.svg = a.firstChild;\n      return a;\n    },\n\n    _createCombinedImageDataDiv: function _createCombinedImageDataDiv(infos) {\n      var a = domConstruct.create(\"div\", { 'class': \"imageDataGFXMulti\" }, this.customSymbolPlaceholder);\n      this.lyrSymbolSet = [];\n      var isDefault = this.symbolInfo && this.symbolInfo.selectedId ? false : true;\n      for (var i = 0; i < infos.length; i++) {\n        var sym = infos[i].symbol;\n        var symbol = jsonUtils.fromJson(sym);\n        if (!symbol) {\n          symbol = sym;\n        }\n        if (typeof this.symbol === 'undefined') {\n          this.symbol = symbol;\n        }\n        this.lyrSymbolSet.push(symbol);\n\n        var height = 26;\n        var width = 26;\n        if (symbol.height && symbol.width) {\n          if (symbol.height > symbol.width) {\n            var ar = symbol.width / symbol.height;\n            height = 26;\n            width = 26 * ar;\n          }\n        }\n\n        var b = domConstruct.create(\"div\", {\n          'class': \"imageDataGFX imageDataGFX2\",\n          'id': \"imageGFX_\" + i,\n          onclick: lang.hitch(this, this.layerSymbolClick)\n        }, a);\n\n        var mySurface = gfx.createSurface(b, width, height);\n        var descriptors = jsonUtils.getShapeDescriptors(this.setSym(symbol, width, height));\n        var shape = mySurface.createShape(descriptors.defaultShape).setFill(descriptors.fill).setStroke(descriptors.stroke);\n        shape.applyTransform({ dx: width / 2, dy: height / 2 });\n        a.insertBefore(b, a.firstChild);\n        a.appendChild(b);\n        if (isDefault || this.symbolInfo && b.id === this.symbolInfo.selectedId) {\n          this.setLayerSymbol(b);\n          isDefault = false;\n        }\n        if (mySurface.rawNode) {\n          html.setStyle(mySurface.rawNode, 'display', \"block\");\n          html.setStyle(mySurface.rawNode, 'margin', \"auto\");\n        }\n      }\n      return a;\n    },\n\n    layerSymbolClick: function layerSymbolClick(evt) {\n      this.setLayerSymbol(evt.currentTarget);\n    },\n\n    setLayerSymbol: function setLayerSymbol(elm) {\n      var idx;\n      for (var i = 0; i < elm.parentElement.children.length; i++) {\n        var child = elm.parentElement.children[i];\n        html.removeClass(child, \"lyrSymbolSelected\");\n        if (child.id === elm.id) {\n          idx = i;\n        }\n      }\n      html.addClass(elm, \"lyrSymbolSelected\");\n      this.selectedID = elm.id;\n      this.svg = elm;\n      this.panelHTML = elm.innerHTML;\n      this.symbol = this.lyrSymbolSet[idx];\n    },\n\n    setSym: function setSym(symbol, width, height) {\n      if (typeof symbol.setWidth !== 'undefined') {\n        if (this.geometryType === 'esriGeometryPoint') {\n          symbol.setWidth(width);\n        }\n        if (typeof symbol.setHeight !== 'undefined') {\n          symbol.setHeight(height);\n        }\n      } else {\n        //used for point symbols from hosted services\n        if (typeof symbol.size !== 'undefined') {\n          if (symbol.size > 20) {\n            symbol.setSize(20);\n          }\n        }\n        //used for point symbols from MapServer services\n        if (typeof symbol.width !== 'undefined') {\n          symbol.width = width;\n        }\n        if (typeof symbol.height !== 'undefined') {\n          symbol.height = height;\n        }\n      }\n\n      return symbol;\n    },\n\n    uploadImage: function uploadImage(type, data) {\n      var node = type === \"Symbol\" ? this.customSymbolPlaceholder : this.customIconPlaceholder;\n      node.innerHTML = \"\";\n      node.innerHTML = domConstruct.create(\"div\", {\n        'class': \"customPlaceholder\",\n        innerHTML: ['<img class=\"customPlaceholder\" src=\"', data, '\"/>'].join(''),\n        title: type === \"Symbol\" ? this.nls.editCustomSymbol : this.nls.editCustomIcon\n      }).innerHTML;\n    },\n\n    _chkGroupChanged: function _chkGroupChanged(v) {\n      this.groupFeaturesEnabled = v;\n      html.setStyle(this.groupByOptions, 'display', v ? \"inline-block\" : \"none\");\n    },\n\n    _rdoGroupByFieldChanged: function _rdoGroupByFieldChanged(v) {\n      this.groupByField = v;\n      this.rdoGroupField.set('checked', v);\n      html.setStyle(this.groupFieldOptions, 'display', v ? \"inline-block\" : \"none\");\n    },\n\n    _rdoGroupByRendererChanged: function _rdoGroupByRendererChanged(v) {\n      this.groupByRenderer = v;\n      this.rdoGroupRenderer.set('checked', v);\n    },\n\n    destroy: function destroy() {\n      this.symbolInfo = null;\n      this.tabContainer.destroyRecursive();\n    }\n  });\n});\n//# sourceMappingURL=MySymbolPicker.js.map\n"]}